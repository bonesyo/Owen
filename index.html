<html>
<head>
    <script src="https://code.jquery.com/jquery.js"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">

    <!-- Optional theme -->
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">
    <link rel="stylesheet" type="text/css" href="./css/style.css" />
    <link rel="stylesheet" type="text/css" href="./css/MyFontsWebfontsKit.css">

    <!-- Latest compiled and minified JavaScript -->
    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
</head>
<body>
    <div class="">

        <header class="col-sm-12 header">
            <p class="col-sm-1 header-text-dot">&#8226;</p>
            <p class="col-sm-5 header-text" id="name">Owen Dodd</p>
            <p class="col-sm-5 header-text">Graphic Design</p>
        </header>

		<div class="top"></div>

            <!--Copy and paste this to make more content  -->
            <div class="card col-sm-12 content">
                <div class="col-sm-1">

                </div>
                <div class="col-sm-12 blocks">
                    <!-- description -->
                    <div class="col-sm-11 col-sm-offset-1">
                        <p class="col-sm-5 desc">
                            I am supposed to stick. When the bottom of me is half way up the page.
                        </p>
                    </div>
                    <div class="col-sm-11 col-sm-offset-1">
                        <img class="col-sm-5 img-responsive images" src="./images/DSC_8569.jpg" alt="image" />
                        <img class="col-sm-5 col-sm-offset-1 img-responsive images" src="./images/DSC_8574.jpg" alt="image" />
                    </div>
                </div>
                <div class="col-sm-10 col-sm-offset-1">
                    <img class="col-sm-12 img-responsive images" src="./images/DSC_8576.jpg" alt="image" />
                </div>


            </div>
            <!-- end of copy -->
            <!--Copy and paste this to make more content  -->
            <div class="card col-sm-12 content-last">
                <div class="col-sm-1">

                </div>
                <div class="col-sm-5 blocks">
                    <p class="col-sm-12 desc">
                        I am suppose to scroll over the other div.
                    </p>
                    <img class="col-sm-12 img-responsive images" src="./images/DSC_8592.jpg" alt="image" />
                    <img class="col-sm-12 img-responsive images" src="./images/DSC_8605.jpg" alt="image" />


                </div>

                <div class="col-sm-5 blocks">
                    <img class="col-sm-12 img-responsive images" src="./images/DSC_8569.jpg" alt="image" />
                    <img class="col-sm-12 img-responsive images" src="./images/DSC_8574.jpg" alt="image" />
                </div>
            </div>
            <!-- end of copy -->

        <div class="o-footer col-sm-12">
                <p class="col-sm-1 footer-text-dot">&#8226;</p>
            <div class="col-sm-4 footer-text">
                <p>Owen Dodd is a graphic designer <br>
                     from Boulder, Colorado, living in <br>
                      New York. <br>
                      <br>
                      Available for freelance projects <br>
                       and other collaborations. <br>
                       <br>
                       <a href="mailto:hi@owendodd.com?Subject=Hello" target="_blank">hi@owendodd.com</a></p>
            </div>
            <div class="col-sm-1">
             </div>
            <div class="col-sm-5 footer-text">
                <p><a href="https://instagram.com/owendodd" target="_blank">Instagram</a></p>
                <p><a href="https://twitter.com/owen_dodd" target="_blank">Twitter</a></p>
                <p><a href="https://ello.co/owen" target="_blank">Ello</a></p>
                <p><a href="http://ovven.tumblr.com" target="_blank">Blog</a></p>
                <p><a href="https://owendodd.vsco.co/" target="_blank">Photos</a></p>
            </div>

        </div>
    </div>

    <script charset="utf-8">
        $(document).ready(function() {

            var pageHeight = window.innerHeight;

            var bgs = [
                'lime',
                'magenta'
            ];

            // grab info for each card (before page has been transformed)
            var cards = [];
            var cardHeight = 0;
            $('.card').each(function(index) {

                cards.push({ elm: this, box: this.getBoundingClientRect(), stuck: false });
                cardHeight = cards[0].box.height;
                console.log(cardHeight);

            });

            // now mess up the page flow with absolute positioning
            cards.forEach(function(card, index) {

                $(card.elm).css({
                    position: 'absolute',
                    'background-color': bgs[index],
                    top: card.box.top
                });

            });

            var handleScrollDown = function() {

                // stick cards when they reach a certain point
                cards.filter(function(elm) {

                    return !elm.stuck;

                }).forEach(function(card, index) {

                    var box = card.elm.getBoundingClientRect();

                    if (box.bottom <= (pageHeight / 2)) {
                        card.stuck = true;
                        $(card.elm).css({
                            position: 'fixed',
                            top: box.top
                        });

                    }


                });

            };

            var handleScrollUp = function() {
                console.log("scrolling up", window.scrollY)

                var newTop =  -cardHeight;

                if(window.scrollY <= cardHeight - 190) {
                    console.log("shicha")
                    cards.filter(function(elm) {

                        return elm.stuck;

                    }).forEach(function(card, index) {
                        console.log(index)
                        card.stuck = false;
                        $(card.elm).css({
                            position: 'relative',
                            top: 0,
                            zIndex: 99
                        });
                    });
                }

            };


            // listen for scroll events and figure out the direction they are scrolling
            // note: gets a little weird on macs
            var scrollingUp = false,
                lastScroll = null;
            $(window).on('scroll', function() {

                var scrollPos = window.scrollY;
                var limit = 2 * cards[0].box.height - 650;
                if(scrollPos >= 2 * cards[0].box.height - 650) {
                    window.scroll(0, limit);
                }
                if (lastScroll) {
                    if (lastScroll > scrollPos) {
                        handleScrollUp();
                    } else {
                        handleScrollDown();
                    }
                }
                lastScroll = scrollPos;


            });

        });
    </script>

</body>
